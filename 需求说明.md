专注声流(ChillFlow) App需求说明文档

# 产品概述
1.1. 产品名称
专注声流 (ChillFlow)
1.2. 愿景
为用户提供一个在工作学习场景中的专注工具，通过番茄钟（结构化专注）与沉浸音乐的融合，帮助用户高效进入并维持心流。
我们相信，通过将番茄钟的“工作/休息”状态与匹配的“专注/放松”背景音乐进行自动同步和平滑过渡，能够比单独使用番茄钟或单独播放音乐，更有效地帮助用户管理认知负荷、减少切换阻力，从而提升专注效率和工作体验。
1.4. 目标用户
核心用户： 开发者、设计师、文字工作者、学生等需要长时间进行深度工作的 Mac 用户。
用户痛点：
使用番茄钟时，需要手动去另一个App（如网易云、Endel）播放/暂停音乐，操作繁琐。
专注时被音乐（尤其是人声或强旋律）打扰；休息时又忘记切换放松音乐。
应用切换本身就是一种“打断”，破坏心流。
1.5. 功能范围
一个 macOS 菜单栏应用 (Menu Bar App)。
一个番茄钟计时器，3个25分钟专注，前2个25分钟专注后休息5分钟，最后1个25分钟专注后休息30分钟。
一个精选的、内置的音频库，包含2个“专注”音频。
核心功能： 计时器状态（工作/休息）自动触发对应音轨的平滑淡入淡出切换。

# 核心用户故事 (User Stories)
角色|我想要 (I want to...)|目的是 (So that...)
深度工作者|点击菜单栏图标，点击“开始专注”，一键开始一个番茄钟循环|立即进入工作状态，无需任何复杂设置。
深度工作者|当“专注”时间开始时，App能自动播放为专注设计的背景音乐|我不必分心去另一款App找音乐，App能帮我“进入状态”。
深度工作者|当“专注”时间结束时，App能自动、平滑地将音乐淡出|给我一个温和的休息提醒，引导我放松大脑，而不是被突然的闹钟打断。
深度工作者|当“休息”时间结束时，App能自动、平滑地切换回（淡入）“专注”音乐|提醒我休息结束，并帮助我“收心”，准备进入下一个工作周期。
用户|暂停或跳过当前的循环（无论是专注还是休息）|灵活应对突发情况（如接电话），保持对工作的掌控。

# 功能需求 (Functional Requirements)
F1: 菜单栏图标 (Menu Bar Icon)，图标默认为一个简单的静态leaf
空闲 (Idle) 状态： 显示 App 静态 Logo。
专注 (Focus) 状态： 显示 App 静态 Logo。
休息 (Rest) 状态： 显示 App 静态 Logo + 剩余时间 (格式 MM:SS)。

F2: 主控制面板 (Main Control Panel)
F2.1: 布局： 点击菜单栏图标后展开的面板，设计必须极简。
F2.2: 核心显示：顶部中间有2个tab，分别是“控制”和“统计”。在顶部右侧有一个退出 (Quit) 按钮。
F2.2.1：“控制”tab从上到下的内容
状态显示： 当前状态的文字（如 "专注", "休息"）。
时间显示： MM:SS 格式的大字体倒计时。
周期显示 (可选)： 显示当前是第几个番茄钟（如 1/4）。
核心控制：
开始专注 (Start) 按钮： 一个按钮，占一行，仅在 空闲 状态下显示，点击后进入 专注 状态。
下方3个按钮，一起占一行。
暂停 (Pause) / 继续 (Resume) 按钮： 在 专注 或 休息 状态下显示。
跳过 (Skip) 按钮：
在 专注 状态下点击，立即结束专注，进入 休息 状态。
在 休息 状态下点击，立即结束休息，进入 专注 状态。
重置 (Reset) 按钮： 停止当前循环，返回 空闲 状态。
在最下方，是一个音量控制条。

F2.2.2：“统计”tab
热力图展示当前一周的专注时长。
顶部展示当前一周的日期范围，从周一至周日。支持左右翻页，切换查看不同的周。
日期范围下方展示当前周的总专注时长。
总专注时长下方，热力图，7*3个格子，即1周7天，1天24小时分为3个格子。当鼠标hover到某个格子上时，上方的“总专注时长”动态变化为该格子的日期、时间段、专注时长。


F3: 番茄钟核心逻辑 (Timer Logic)
F3.1: 状态： App 必须包含以下核心状态：Idle (空闲)、Focus (专注)、Rest (休息)、Long Rest (长休息)、Paused (暂停)。
F3.2: 番茄钟时长：
Focus 时长: 25 分钟。
Rest 时长: 5 分钟。
Long Rest 时长: 15 分钟。
长休息间隔: 3 个 Focus 周期后触发一次 Long Rest。
F3.3: 状态转换：
Idle -> Start -> Focus (1)。
Focus (n) 结束 -> Rest (n) (如果 n < 3)。
Rest (n) 结束 -> Focus (n+1) (如果 n < 3)。
Focus (4) 结束 -> Long Rest。
Long Rest 结束 -> Idle (或自动开始新循环，TBD)。
F4: 声景引擎 (Soundscape Engine - Scheme B)
F4.1: 内置音轨库 (MVP核心)：
App 必须内置（打包在 App 内，无需下载）至少 2 首音频文件。
Focus-Track-01.mp3 (专注音乐，如轻微白噪音、Alpha波)
Focus-Track-02.mp3 (专注音乐，如环境雨声)
<!-- Rest-Track-01.mp3 (放松音乐，如冥想、空灵，长度 > 5分钟)
Rest-Track-02.mp3 (放松音乐，如自然风声，长度 > 5分钟) -->
F4.2: 播放逻辑：
播放时应随机选择一首对应状态的音乐，并循环播放。
F4.3: 状态同步逻辑 (关键功能)：
当 F3 状态从 Idle 变为 Focus 时，F4 淡入 (Fade-in) 一首 Focus-Track。
当 F3 状态从 Focus 变为 Rest 时，F4 淡出 (Fade-out) 当前的 Focus-Track。
当 F3 状态从 Rest 变为 Focus 时，淡入 (Fade-in) 一首 Focus-Track。
F4.4: 平滑过渡 (Cross-fade)：
F4.3 中的“淡入/淡出”必须是平滑的，过渡时长约为 3-5 秒。严禁声音的突然中断或播放。
F4.5: 控制：
暂停 (Pause) 时，声音应平滑淡出。继续 (Resume) 时，声音应平滑淡入。
App 内应提供一个音量控制条。


# 非功能需求 (Non-Functional Requirements)
类别|需求
性能|作为一个常驻后台的菜单栏应用，必须极度轻量。空闲时 CPU 占用 < 1%，播放音频时 < 5%。内存占用 < 100MB。
稳定性|计时器必须精准，后台运行时不得“休眠”或停止计时。音频播放不得无故中断。
离线|所有核心功能（计时、播放内置音乐）必须 100% 离线可用。
兼容性|支持 macOS 12 (Monterey)及以上版本。
美学|界面风格应遵循 macOS 原生设计规范，保持简洁、克制。
