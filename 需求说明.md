「专注声流」(ChillFlow) App
MVP 需求说明文档 (PRD)

# 产品概述
1.1. 产品名称
专注声流 (ChillFlow)
1.2. 愿景
为深度工作者提供一个“认知状态”与“听觉环境”智能同步的工作流工具，通过“结构化专注”与“沉浸式环境”的融合，帮助用户高效进入并维持心流。
1.3. MVP 目标 (Hypothesis)
核心假设： 我们相信，通过将番茄钟的“工作/休息”状态与匹配的“专注/放松”背景音乐进行自动同步和平滑过渡，能够比单独使用番茄钟或单独播放音乐，更有效地帮助用户管理认知负荷、减少切换阻力，从而提升专注效率和工作体验。
1.4. 目标用户
核心用户： 开发者、设计师、文字工作者、学生等需要长时间进行深度工作的 Mac 用户。
用户痛点：
使用番茄钟时，需要手动去另一个App（如网易云、Endel）播放/暂停音乐，操作繁琐。
专注时被音乐（尤其是人声或强旋律）打扰；休息时又忘记切换放松音乐。
应用切换本身就是一种“打断”，破坏心流。
1.5. MVP 范围 (In Scope)
一个 macOS 菜单栏应用 (Menu Bar App)。
一个可自定义时长的番茄钟计时器。
一个精选的、内置的音频库（方案B），包含至少2组“专注”和“放松”的循环音轨。
核心功能： 计时器状态（工作/休息）自动触发对应音轨的平滑淡入淡出切换。

# 核心用户故事 (User Stories)
角色|我想要 (I want to...)|目的是 (So that...)
深度工作者|点击菜单栏图标，一键开始一个番茄钟循环|立即进入工作状态，无需任何复杂设置。
深度工作者|当“专注”时间开始时，App能自动播放为专注设计的背景音乐|我不必分心去另一款App找音乐，App能帮我“进入状态”。
深度工作者|当“专注”时间结束时，App能自动、平滑地将音乐切换到“放松”风格|给我一个清晰、温和的休息提醒，引导我放松大脑，而不是被突然的闹钟打断。
深度工作者|当“休息”时间结束时，App能自动、平滑地切换回“专注”音乐|提醒我休息结束，并帮助我“收心”，准备进入下一个工作周期。
自律者|在设置中自定义我的“工作时长”和“休息时长”|让App的节律匹配我个人的工作习惯（如 50/10 分钟）。
用户|暂停或跳过当前的循环（无论是专注还是休息）|灵活应对突发情况（如接电话），保持对工作的掌控。

# 功能需求 (Functional Requirements)
F1: 菜单栏图标 (Menu Bar Icon)
F1.1: 状态显示： 菜单栏图标必须实时显示当前状态和剩余时间。
空闲 (Idle) 状态： 显示 App 静态 Logo。
专注 (Focus) 状态： 显示 Logo + 剩余时间 (格式 MM:SS)。
休息 (Rest) 状态： 显示一个不同的 Logo (如月亮/Zzz) + 剩余时间 (格式 MM:SS)。
F1.2: 交互：
左键单击： 展开“主控制面板 (F2)”。
右键单击 (可选)： 弹出快捷菜单（开始、暂停、退出）。
F2: 主控制面板 (Main Control Panel)
F2.1: 布局： 点击菜单栏图标后展开的面板，设计必须极简。
F2.2: 核心显示：
状态显示： 当前状态的文字（如 "专注", "休息"）。
时间显示： MM:SS 格式的大字体倒计时。
周期显示 (可选)： 显示当前是第几个番茄钟（如 1/4）。
F2.3: 核心控制：
开始 (Start) 按钮： 仅在 空闲 状态下显示。点击后进入 专注 状态。
暂停 (Pause) / 继续 (Resume) 按钮： 在 专注 或 休息 状态下显示。
跳过 (Skip) 按钮：
在 专注 状态下点击，立即结束专注，进入 休息 状态。
在 休息 状态下点击，立即结束休息，进入 专注 状态。
重置 (Reset) 按钮： 停止当前循环，返回 空闲 状态。
F2.4: 其他入口：
设置 (Settings) 入口： 一个齿轮图标，点击进入 F5 设置面板。
退出 (Quit) 入口： 退出 App。
F3: 番茄钟核心逻辑 (Timer Logic)
F3.1: 状态机： App 必须包含以下核心状态：
Idle (空闲)
Focus (专注)
Rest (休息)
Long Rest (长休息)
Paused (暂停)
F3.2: 默认值：
Focus 时长: 25 分钟。
Rest 时长: 5 分钟。
Long Rest 时长: 15 分钟。
长休息间隔: 4 个 Focus 周期后触发一次 Long Rest。
F3.3: 状态转换：
Idle -> Start -> Focus (1)。
Focus (n) 结束 -> Rest (n) (如果 n < 4)。
Rest (n) 结束 -> Focus (n+1)。
Focus (4) 结束 -> Long Rest。
Long Rest 结束 -> Idle (或自动开始新循环，TBD)。
F4: 声景引擎 (Soundscape Engine - Scheme B)
F4.1: 内置音轨库 (MVP核心)：
App 必须内置（打包在 App 内，无需下载）至少 4 首免版税(Royalty-Free)的音频文件。
Focus-Track-01.mp3 (专注音乐，如轻微白噪音、Alpha波，长度 > 10分钟)
Focus-Track-02.mp3 (专注音乐，如环境雨声，长度 > 10分钟)
Rest-Track-01.mp3 (放松音乐，如冥想、空灵，长度 > 5分钟)
Rest-Track-02.mp3 (放松音乐，如自然风声，长度 > 5分钟)
F4.2: 播放逻辑：
播放时应随机选择一首对应状态的音乐，并循环播放。
F4.3: 状态同步逻辑 (关键功能)：
当 F3 状态从 Idle 变为 Focus 时，F4 淡入 (Fade-in) 一首 Focus-Track。
当 F3 状态从 Focus 变为 Rest 时，F4 淡出 (Fade-out) 当前的 Focus-Track，同时淡入 (Fade-in) 一首 Rest-Track。
当 F3 状态从 Rest 变为 Focus 时，F4 淡出 (Fade-out) 当前的 Rest-Track，同时淡入 (Fade-in) 一首 Focus-Track。
F4.4: 平滑过渡 (Cross-fade)：
F4.3 中的“淡入/淡出”必须是平滑的，过渡时长约为 3-5 秒。严禁声音的突然中断或播放。
F4.5: 控制：
暂停 (Pause) 时，声音应平滑淡出。继续 (Resume) 时，声音应平滑淡入。
App 内应提供一个音量控制条。
F5: 设置面板 (Settings Panel)
F5.1: 计时器设置：
提供数字输入框 (Number Input) 允许用户自定义：
专注时长 (分钟)
休息时长 (分钟)
长休息时长 (分钟)
长休息间隔 (周期数)
F5.2: 系统设置：
提供复选框 (Checkbox)：
开机自启动 (Launch at Login)
启用系统通知 (Enable Notifications) (在 Focus / Rest 结束时发送)
自动开始下一个循环 (Auto-start next cycle)

# 非功能需求 (Non-Functional Requirements)
类别|需求
性能|作为一个常驻后台的菜单栏应用，必须极度轻量。空闲时 CPU 占用 < 1%，播放音频时 < 5%。内存占用 < 100MB。
稳定性|计时器必须精准，后台运行时不得“休眠”或停止计时。音频播放不得无故中断。
易用性|首次启动无需任何配置，默认值 (25/5) 必须可直接使用。
离线|所有核心功能（计时、播放内置音乐）必须 100% 离线可用。
兼容性|支持 macOS 12 (Monterey)及以上版本。
美学|界面风格应遵循 macOS 原生设计规范，保持简洁、克制。
